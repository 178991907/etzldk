"use strict";exports.id=248,exports.ids=[248],exports.modules={777:(e,t,r)=>{r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet4.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet4.tsx","default")},6211:(e,t,r)=>{r.d(t,{A0:()=>i,BF:()=>l,Hj:()=>d,XI:()=>s,nA:()=>u,nd:()=>c});var a=r(60687),n=r(43210),o=r(4780);let s=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,o.cn)("w-full caption-bottom text-sm",e),...t})}));s.displayName="Table";let i=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("thead",{ref:r,className:(0,o.cn)("[&_tr]:border-b",e),...t}));i.displayName="TableHeader";let l=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("tbody",{ref:r,className:(0,o.cn)("[&_tr:last-child]:border-0",e),...t}));l.displayName="TableBody",n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("tfoot",{ref:r,className:(0,o.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let d=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("tr",{ref:r,className:(0,o.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("th",{ref:r,className:(0,o.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let u=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("td",{ref:r,className:(0,o.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",n.forwardRef(({className:e,...t},r)=>(0,a.jsx)("caption",{ref:r,className:(0,o.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},22911:(e,t,r)=>{r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet1.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet1.tsx","default")},24320:(e,t,r)=>{r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet2.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet2.tsx","default")},26009:(e,t,r)=>{r.d(t,{getDefaultRewards:()=>n});var a=r(12907);(0,a.registerClientReference)(function(){throw Error("Attempted to call getClientUser() from the server but getClientUser is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getClientUser"),(0,a.registerClientReference)(function(){throw Error("Attempted to call updateClientUser() from the server but updateClientUser is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","updateClientUser"),(0,a.registerClientReference)(function(){throw Error("Attempted to call getClientTasks() from the server but getClientTasks is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getClientTasks"),(0,a.registerClientReference)(function(){throw Error("Attempted to call saveClientTask() from the server but saveClientTask is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","saveClientTask"),(0,a.registerClientReference)(function(){throw Error("Attempted to call deleteClientTask() from the server but deleteClientTask is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","deleteClientTask"),(0,a.registerClientReference)(function(){throw Error("Attempted to call completeClientTaskAndUpdateXP() from the server but completeClientTaskAndUpdateXP is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","completeClientTaskAndUpdateXP"),(0,a.registerClientReference)(function(){throw Error("Attempted to call getClientAchievements() from the server but getClientAchievements is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getClientAchievements"),(0,a.registerClientReference)(function(){throw Error("Attempted to call updateClientAchievements() from the server but updateClientAchievements is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","updateClientAchievements"),(0,a.registerClientReference)(function(){throw Error("Attempted to call getClientTodaysTasks() from the server but getClientTodaysTasks is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getClientTodaysTasks");let n=(0,a.registerClientReference)(function(){throw Error("Attempted to call getDefaultRewards() from the server but getDefaultRewards is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getDefaultRewards");(0,a.registerClientReference)(function(){throw Error("Attempted to call getClientRewards() from the server but getClientRewards is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","getClientRewards"),(0,a.registerClientReference)(function(){throw Error("Attempted to call addClientReward() from the server but addClientReward is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","addClientReward"),(0,a.registerClientReference)(function(){throw Error("Attempted to call updateClientReward() from the server but updateClientReward is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","updateClientReward"),(0,a.registerClientReference)(function(){throw Error("Attempted to call deleteClientReward() from the server but deleteClientReward is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/lib/client-data.ts","deleteClientReward")},32767:(e,t,r)=>{r.r(t),r.d(t,{achievements:()=>f,rewards:()=>p,tasks:()=>u,users:()=>c});var a=r(39281),n=r(29334),o=r(10542),s=r(34509),i=r(50033),l=r(54693),d=r(9253);let c=(0,a.cJ)("users",{id:(0,n.Qq)("id").primaryKey(),name:(0,n.Qq)("name").notNull(),avatar:(0,n.Qq)("avatar").notNull(),level:(0,o.nd)("level").default(1).notNull(),xp:(0,o.nd)("xp").default(0).notNull(),xpToNextLevel:(0,o.nd)("xp_to_next_level").default(100).notNull(),petStyle:(0,n.Qq)("pet_style").notNull(),petName:(0,n.Qq)("pet_name").notNull(),appLogo:(0,n.Qq)("app_logo"),pomodoroSettings:(0,s.Fx)("pomodoro_settings"),appName:(0,n.Qq)("app_name"),landingTitle:(0,n.Qq)("landing_title"),landingDescription:(0,n.Qq)("landing_description"),landingCta:(0,n.Qq)("landing_cta"),dashboardLink:(0,n.Qq)("dashboard_link")}),u=(0,a.cJ)("tasks",{id:(0,i.vX)("id").primaryKey(),userId:(0,n.Qq)("user_id").notNull().references(()=>c.id),title:(0,n.Qq)("title").notNull(),category:(0,n.Qq)("category").notNull(),difficulty:(0,n.Qq)("difficulty").notNull(),completed:(0,l.zM)("completed").default(!1).notNull(),status:(0,n.Qq)("status",{enum:["active","paused"]}).default("active").notNull(),dueDate:(0,d.vE)("due_date").notNull(),recurrence:(0,s.Fx)("recurrence"),time:(0,n.Qq)("time")}),f=(0,a.cJ)("achievements",{id:(0,i.vX)("id").primaryKey(),userId:(0,n.Qq)("user_id").notNull().references(()=>c.id),title:(0,n.Qq)("title").notNull(),description:(0,n.Qq)("description"),icon:(0,n.Qq)("icon").notNull(),imageUrl:(0,n.Qq)("image_url"),unlocked:(0,l.zM)("unlocked").default(!1).notNull(),dateUnlocked:(0,d.vE)("date_unlocked"),tasksRequired:(0,o.nd)("tasks_required"),daysRequired:(0,o.nd)("days_required")}),p=(0,a.cJ)("rewards",{id:(0,n.Qq)("id").primaryKey(),userId:(0,n.Qq)("user_id").notNull().references(()=>c.id),title:(0,n.Qq)("title").notNull(),description:(0,n.Qq)("description"),icon:(0,n.Qq)("icon").notNull(),tasksRequired:(0,o.nd)("tasks_required"),daysRequired:(0,o.nd)("days_required"),isCustom:(0,l.zM)("is_custom").default(!0)})},54987:(e,t,r)=>{r.d(t,{d:()=>i});var a=r(60687),n=r(43210),o=r(90270),s=r(4780);let i=n.forwardRef(({className:e,...t},r)=>(0,a.jsx)(o.bL,{className:(0,s.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:(0,a.jsx)(o.zi,{className:(0,s.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));i.displayName=o.bL.displayName},56397:(e,t,r)=>{r.d(t,{K:()=>c});var a=r(76457),n=r(64718),o=r(10113),s=r(68597),i=r(25361),l=r(21653),d=r(24482);let c={Learning:a.A,Creative:n.A,Health:o.A,School:s.A,Activity:i.A,Bed:l.A,Gift:d.A}},65613:(e,t,r)=>{r.d(t,{Nd:()=>M,zR:()=>S,Zc:()=>j,vq:()=>E,$_:()=>_,Pd:()=>K,uD:()=>C,x1:()=>U,Ji:()=>B,wz:()=>x,fd:()=>L,qn:()=>O,ID:()=>Q,hZ:()=>J,KD:()=>z,TK:()=>T});var a=r(67218);r(79130);var n=r(71682),o=r(32767),s=r(94634),i=r(22911),l=r(24320),d=r(73421),c=r(777),u=r(81611);let f=[{id:"pet1",name:"Blobby",unlockLevel:1,component:i.default},{id:"pet2",name:"Spiky",unlockLevel:2,component:l.default},{id:"pet3",name:"Cacto",unlockLevel:5,component:d.default},{id:"pet4",name:"Boxy",unlockLevel:10,component:c.default},{id:"pet5",name:"Cloudy",unlockLevel:15,component:u.default}];f.reduce((e,t)=>(e[t.id]=t.component,e),{}),f.map(e=>e.id);let p={Easy:5,Medium:10,Hard:15},m=e=>{let t=[...f].sort((e,t)=>t.unlockLevel-e.unlockLevel).find(t=>e>=t.unlockLevel);return t?t.id:"pet1"};function w(e,t,r,a,n){let o=p[a]||0,s=e+(n?o:-o);s<0&&(s=0);let i=t,l=r;for(;s>=l;)i++,s-=l,l=Math.floor(1.2*l);return{newXp:s,newLevel:i,newXpToNextLevel:l,newPetStyle:m(i)}}function b(e){if("active"!==e.status)return!1;let t=new Date,r=t.toDateString();if(e.recurrence){let{unit:r,daysOfWeek:a}=e.recurrence;if("week"===r&&a&&a.length>0){let e=["sun","mon","tue","wed","thu","fri","sat"][t.getDay()];return a.includes(e)}}return new Date(e.dueDate).toDateString()===r}let v=()=>"undefined"!=typeof KV?KV:"undefined"!=typeof process&&process.env&&process.env.KV?process.env.KV:"undefined"!=typeof DISCIPLINE_KV?DISCIPLINE_KV:null,h={async get(e){let t=v();if(!t)return null;try{let r=await t.get(e);return r?JSON.parse(r):null}catch(t){return console.error(`KV Get Error for ${e}:`,t),null}},async put(e,t){let r=v();if(r)try{await r.put(e,JSON.stringify(t))}catch(t){console.error(`KV Put Error for ${e}:`,t)}},async delete(e){let t=v();if(t)try{await t.delete(e)}catch(t){console.error(`KV Delete Error for ${e}:`,t)}},isAvailable:()=>!!v()};var y=r(26009),k=r(17478);let g="user_2fP7sW5gR8zX9yB1eA6vC4jK0lM";async function C(){return n.L?h.isAvailable()?"kv":"local":"db"}let D={modes:[{id:"work",name:"Work",duration:25},{id:"shortBreak",name:"Short Break",duration:5},{id:"longBreak",name:"Long Break",duration:15}],longBreakInterval:4},q=()=>({id:g,name:"Alex",avatar:"avatar1",level:1,xp:75,xpToNextLevel:100,petStyle:"pet1",petName:"泡泡",appLogo:"",pomodoroSettings:D,appName:"儿童自律打卡",landingTitle:"Gamify Your Child's Habits",landingDescription:"Turn daily routines and learning into a fun adventure. Motivate your kids with rewards, achievements, and a virtual pet that grows with them.",landingCta:"Get Started for Free",dashboardLink:"设置页面"}),A=()=>{let e=new Date;return[{id:`default-${Date.now()}-1`,userId:g,title:"Read for 20 minutes",category:"Learning",icon:"Learning",difficulty:"Easy",completed:!1,status:"active",dueDate:e,recurrence:{interval:1,unit:"week",daysOfWeek:["mon","tue","wed","thu","fri"]},time:"20:00"},{id:`default-${Date.now()}-2`,userId:g,title:"Practice drawing",category:"Creative",icon:"Creative",difficulty:"Medium",completed:!1,status:"active",dueDate:e,recurrence:{interval:1,unit:"week",daysOfWeek:["tue","thu"]},time:"16:30"}]},R=()=>[{id:`default-${Date.now()}-1`,userId:g,title:"First Mission",description:"Complete your very first task.",icon:"Star",unlocked:!0,dateUnlocked:new Date(new Date().setDate(new Date().getDate()-5))},{id:`default-${Date.now()}-2`,userId:g,title:"Task Master",description:"Complete 10 tasks in total.",icon:"Trophy",unlocked:!0,dateUnlocked:new Date(new Date().setDate(new Date().getDate()-2))},{id:`default-${Date.now()}-3`,userId:g,title:"Perfect Week",description:"Complete all your tasks for 7 days in a row.",icon:"ShieldCheck",unlocked:!1}],N=e=>{if(!e)return q();let t="string"==typeof e.pomodoroSettings?JSON.parse(e.pomodoroSettings):e.pomodoroSettings||D;return{...e,pomodoroSettings:t}};async function x(){if(n.L){if(h.isAvailable()){let e=await h.get(`user:${g}`);if(e)return e;let t=q();return await h.put(`user:${g}`,t),t}return q()}try{let e=await n.db.query.users.findFirst({where:(0,s.eq)(o.users.id,g)});if(!e){let t=q(),r={...t,pomodoroSettings:t.pomodoroSettings?JSON.stringify(t.pomodoroSettings):null};await n.db.insert(o.users).values(r),e=await n.db.query.users.findFirst({where:(0,s.eq)(o.users.id,g)})}return N(e)}catch(e){return console.error("DB Error: Failed to fetch/create user. Falling back.",e),q()}}async function T(e){if(n.L){if(h.isAvailable()){let t={...await h.get(`user:${g}`)||q(),...e};await h.put(`user:${g}`,t)}return}try{let t={...e};e.pomodoroSettings&&(t.pomodoroSettings=JSON.stringify(e.pomodoroSettings)),await n.db.update(o.users).set(t).where((0,s.eq)(o.users.id,g))}catch(e){throw console.error("Failed to update user in DB",e),e}}let I=e=>({...e,id:e.id.toString(),recurrence:e.recurrence&&"string"==typeof e.recurrence?JSON.parse(e.recurrence):e.recurrence,dueDate:e.dueDate?new Date(e.dueDate):new Date});async function U(){if(n.L){if(h.isAvailable()){let e=await h.get(`tasks:${g}`);if(e)return e.map(e=>({...e,dueDate:new Date(e.dueDate)}));let t=A();return await h.put(`tasks:${g}`,t),t}return A()}try{let e=await n.db.query.tasks.findMany({where:(0,s.eq)(o.tasks.userId,g)});if(0===e.length){let t=A().map(e=>({...e,userId:g,recurrence:e.recurrence?JSON.stringify(e.recurrence):null}));await n.db.insert(o.tasks).values(t.map(({id:e,...t})=>t)),e=await n.db.query.tasks.findMany({where:(0,s.eq)(o.tasks.userId,g)})}return e.map(I)}catch(e){return console.error("DB Error: Failed to fetch tasks. Falling back.",e),A()}}async function S(e,t){if(n.L){if(h.isAvailable()){let r=await h.get(`user:${g}`)||q(),a=await h.get(`tasks:${g}`)||A(),n=a.find(t=>t.id===e.id);if(!n||t===n.completed)return;let{newXp:o,newLevel:s,newXpToNextLevel:i,newPetStyle:l}=w(r.xp,r.level,r.xpToNextLevel,n.difficulty,t),d={...r,xp:o,level:s,xpToNextLevel:i,petStyle:l};await h.put(`user:${g}`,d);let c=a.map(r=>r.id===e.id?{...r,completed:t}:r);await h.put(`tasks:${g}`,c)}return}let r=await x(),a=await n.db.query.tasks.findFirst({where:(0,s.eq)(o.tasks.id,parseInt(e.id))});if(!a||t===a.completed)return;let{newXp:i,newLevel:l,newXpToNextLevel:d,newPetStyle:c}=w(r.xp,r.level,r.xpToNextLevel,a.difficulty,t);try{await T({xp:i,level:l,xpToNextLevel:d,petStyle:c}),await n.db.update(o.tasks).set({completed:t}).where((0,s.eq)(o.tasks.id,parseInt(e.id)))}catch(e){throw console.error("Failed to complete task and update XP in DB",e),e}}async function L(e,t){if(n.L){if(h.isAvailable()){let r=await h.get(`tasks:${g}`)||A();t?r=r.map(r=>r.id===t?{...r,...e,id:t,userId:g}:r):r.unshift({...e,id:`kv-${Date.now()}`,userId:g}),await h.put(`tasks:${g}`,r)}return}let r={...e,userId:g,recurrence:e.recurrence?JSON.stringify(e.recurrence):null,dueDate:e.dueDate||new Date};try{t&&!isNaN(parseInt(t))?await n.db.update(o.tasks).set(r).where((0,s.eq)(o.tasks.id,parseInt(t,10))):await n.db.insert(o.tasks).values(r)}catch(e){throw console.error("Failed to save task to DB",e),e}}async function E(e){if(n.L){if(h.isAvailable()){let t=await h.get(`tasks:${g}`)||A();t=t.filter(t=>t.id!==e),await h.put(`tasks:${g}`,t)}return}if(e&&!isNaN(parseInt(e)))try{await n.db.delete(o.tasks).where((0,s.eq)(o.tasks.id,parseInt(e)))}catch(e){throw console.error("Failed to delete task from DB",e),e}}async function z(e){console.warn("updateTasks is not implemented for DB/KV via data-browser.")}let $=e=>({...e,id:e.id.toString(),dateUnlocked:e.dateUnlocked?new Date(e.dateUnlocked):void 0});async function _(){if(n.L)return[];try{let e=await n.db.query.achievements.findMany({where:(0,s.eq)(o.achievements.userId,g)});if(0===e.length){let t=R().map(e=>({...e,userId:g,dateUnlocked:e.dateUnlocked?new Date(e.dateUnlocked):null}));await n.db.insert(o.achievements).values(t.map(({id:e,...t})=>t)),e=await n.db.query.achievements.findMany({where:(0,s.eq)(o.achievements.userId,g)})}return e.map($)}catch(e){return console.error("DB Error: Failed to fetch achievements. Falling back.",e),[]}}async function Q(e){if(!n.L)try{if(await n.db.delete(o.achievements).where((0,s.eq)(o.achievements.userId,g)),e.length>0){let t=e.map(e=>{let{id:t,...r}=e;return{...r,userId:g,dateUnlocked:e.dateUnlocked?new Date(e.dateUnlocked):null}});await n.db.insert(o.achievements).values(t)}}catch(e){throw console.error("Failed to save achievements to DB",e),e}}async function B(){try{let e=await U();if(!e)return[];return e.filter(b)}catch(e){return console.error("Error in getTodaysTasks",e),[]}}let F=e=>({...e,id:e.id.toString()});async function K(){if(n.L){if(h.isAvailable()){let e=await h.get(`rewards:${g}`);if(e)return e;let t=(0,y.getDefaultRewards)();return await h.put(`rewards:${g}`,t),t}return(0,y.getDefaultRewards)()}try{let e=await n.db.query.rewards.findMany({where:(0,s.eq)(o.rewards.userId,g)});if(0===e.length){let t=(0,y.getDefaultRewards)().map(e=>({...e,userId:g}));await n.db.insert(o.rewards).values(t),e=await n.db.query.rewards.findMany({where:(0,s.eq)(o.rewards.userId,g)})}return e.map(F)}catch(e){return console.error("DB Error: Failed to fetch rewards. Falling back.",e),(0,y.getDefaultRewards)()}}async function M(e){if(n.L){if(h.isAvailable()){let t=await h.get(`rewards:${g}`)||(0,y.getDefaultRewards)();t.push(e),await h.put(`rewards:${g}`,t)}return}try{let t={...e,userId:g};await n.db.insert(o.rewards).values(t)}catch(e){throw console.error("Failed to add reward to DB",e),e}}async function J(e){if(n.L){if(h.isAvailable()){let t=await h.get(`rewards:${g}`)||(0,y.getDefaultRewards)();t=t.map(t=>t.id===e.id?e:t),await h.put(`rewards:${g}`,t)}return}try{await n.db.update(o.rewards).set({title:e.title,description:e.description,tasksRequired:e.tasksRequired,daysRequired:e.daysRequired}).where((0,s.eq)(o.rewards.id,e.id))}catch(e){throw console.error("Failed to update reward in DB",e),e}}async function j(e){if(n.L){if(h.isAvailable()){let t=await h.get(`rewards:${g}`)||(0,y.getDefaultRewards)();t=t.filter(t=>t.id!==e),await h.put(`rewards:${g}`,t)}return}try{await n.db.delete(o.rewards).where((0,s.eq)(o.rewards.id,e))}catch(e){throw console.error("Failed to delete reward from DB",e),e}}async function O(e,t,r,a){if(n.L)return{success:!1,error:"Database connection is not available."};console.log("Starting data sync...");try{let i={...e};if(delete i.id,i.pomodoroSettings&&(i.pomodoroSettings=JSON.stringify(i.pomodoroSettings)),await n.db.update(o.users).set(i).where((0,s.eq)(o.users.id,g)),console.log("User synced."),await n.db.delete(o.tasks).where((0,s.eq)(o.tasks.userId,g)),t.length>0){let e=t.map(e=>({userId:g,title:e.title,category:e.category,difficulty:e.difficulty,completed:e.completed,status:e.status,dueDate:new Date(e.dueDate),recurrence:e.recurrence?JSON.stringify(e.recurrence):null,time:e.time}));await n.db.insert(o.tasks).values(e)}if(await n.db.delete(o.achievements).where((0,s.eq)(o.achievements.userId,g)),r.length>0){let e=r.map(e=>({userId:g,title:e.title,description:e.description,icon:e.icon,imageUrl:e.imageUrl,unlocked:e.unlocked,dateUnlocked:e.dateUnlocked?new Date(e.dateUnlocked):null,tasksRequired:e.tasksRequired,daysRequired:e.daysRequired}));await n.db.insert(o.achievements).values(e)}if(await n.db.delete(o.rewards).where((0,s.eq)(o.rewards.userId,g)),a.length>0){let e=a.map(e=>({id:e.id,userId:g,title:e.title,description:e.description,icon:e.icon,tasksRequired:e.tasksRequired,daysRequired:e.daysRequired,isCustom:e.isCustom}));await n.db.insert(o.rewards).values(e)}return{success:!0}}catch(e){return console.error("Sync failed:",e),{success:!1,error:e.message}}}(0,k.D)([C,x,T,U,S,L,E,z,_,Q,B,K,M,J,j,O]),(0,a.A)(C,"008effac9009dd232114859669e03c30e78c683c70",null),(0,a.A)(x,"00ae0494fd0768734059b34c9a487b0bfb61256060",null),(0,a.A)(T,"401faf5091786dd5b9af3a259c27aa22910dc6ed6f",null),(0,a.A)(U,"00c9ec05a9bd6a6eb27e5eddd333aad140997d4f18",null),(0,a.A)(S,"60b4529348658197a0c957738d4e45c653e0047bae",null),(0,a.A)(L,"60b9b3f572c048794dd788082b8c8b7c45ec4cfba6",null),(0,a.A)(E,"40c3e5942eeb2adf02a27622d8ff12bfdb8f751e99",null),(0,a.A)(z,"4012e67bc15a80780dd8e4614517bed2024b211d8e",null),(0,a.A)(_,"001f1a97e895fca6c4973fa7a838917f8efc977f21",null),(0,a.A)(Q,"403c3d7d447e36c7c3c20a6ab08421d5ded7604bff",null),(0,a.A)(B,"0061e8ed72e9caca809ed305bb705d36e7e6c68903",null),(0,a.A)(K,"006269b314e2c0e1e338a3f1202a0b3d6ff398c717",null),(0,a.A)(M,"40e79025bcb48ca3fd66c9f7f7b15ddb7bccee7cce",null),(0,a.A)(J,"40497671f8c88d919706b0a4030b3048b73c1ddc77",null),(0,a.A)(j,"401531637c46353fb1d6a7e420ca8e01a91653238b",null),(0,a.A)(O,"7808e5c037e6ccec8af9e7b0595a82818e193863ec",null)},70440:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var a=r(31658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},71682:(e,t,r)=>{let a;r.d(t,{L:()=>i,db:()=>a});var n=r(52518),o=r(88909),s=r(32767);r(95710);let i=null,l=process.env.DATABASE_URL;if(l)try{let e=l.match(/postgresql:\/\/[^'"]+/);e&&(l=e[0]);let t=(0,o.lw)(l);a=(0,n.fd)(t,{schema:s})}catch(e){console.error(i=Error(`Failed to initialize database: ${e.message}`))}else i=Error("DATABASE_URL is not set. Database operations will be disabled.")},73421:(e,t,r)=>{r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet3.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet3.tsx","default")},81611:(e,t,r)=>{r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet5.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Terry/Downloads/zilvdaka-main 2/src/components/icons/pet5.tsx","default")}};